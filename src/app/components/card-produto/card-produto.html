<div class="card h-100 product-card" [ngClass]="getCategoryClass()" (click)="onProductClick()">
  <div class="card-img-container">
    <img [src]="product.thumbnail" [alt]="product.title" class="card-img-top product-image">
    @if (product.discountPercentage > 0) {
      <span class="badge bg-danger discount-badge">-{{ product.discountPercentage | number:'1.0-0' }}%</span>
    }
  </div>
  
  <div class="card-body d-flex flex-column">
    <h5 class="card-title text-truncate" [title]="product.title">{{ product.title }}</h5>
    <p class="card-text text-muted small flex-grow-1">{{ product.description | slice:0:80 }}{{ product.description.length > 80 ? '...' : '' }}</p>
    
    <div class="price-section mb-2">
      @if (product.discountPercentage > 0) {
        <span class="text-muted text-decoration-line-through small me-2">{{ product.price | currency:'BRL':'symbol':'1.2-2' }}</span>
        <span class="fw-bold text-success">{{ getDiscountedPrice() | currency:'BRL':'symbol':'1.2-2' }}</span>
      } @else {
        <span class="fw-bold">{{ product.price | currency:'BRL':'symbol':'1.2-2' }}</span>
      }
    </div>
    
    <div class="d-flex justify-content-between align-items-center">
      <small class="text-muted">
        <i class="bi bi-star-fill text-warning"></i>
        {{ product.rating | number:'1.1-1' }}
      </small>
      <button 
        type="button" 
        class="btn btn-primary btn-sm"
        (click)="onAddToCart($event)"
        [disabled]="product.stock === 0">
        @if (product.stock === 0) {
          Esgotado
        } @else {
          Adicionar ao Carrinho
        }
      </button>
    </div>
    
    @if (product.stock > 0 && product.stock <= 10) {
      <small class="text-warning mt-1">
        <i class="bi bi-exclamation-triangle"></i>
        Apenas {{ product.stock }} em estoque
      </small>
    }
  </div>
</div>